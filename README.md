**销售出库单表格格式**：
- DZ列：物料编码（如：8.01.1.01.01.206）
- FF列：批号（如：Z25050086）
- FG列：批号（如：Z25050086）
- GJ列：仓库名称（如：成都亚一公共平台仓2号库）
- HA列：销售数量（如：100）

**即时库存表格式**：
- A列：物料编码（如：8.01.1.01.01.233）
- G列：仓库名称（如：成都亚一公共平台仓2号库）
- H列：批号（如：Z25050091）
- K列：可用量（如：161）
- D、E、F列：辅助属性

## 文件结构

- `main.py` - 主程序入口
- `ui_main.py` - 图形用户界面
- `logic.py` - 表格处理逻辑
- `utils.py` - 工具函数

## 注意事项

- 请确保Excel文件格式正确，必须包含所有必要列
- 程序会直接修改销售出库单文件并标记修改内容为红色
- 物料编码必须符合 x.xx.x.xx.xx.xxx 格式（6段数字，用点分隔）
- 批次号分配会根据库存量自动分配，确保不会超出库存限制
- 程序会自动跳过前两行（标题行），从第三行开始处理数据

## 功能特点

1. **智能批次分配**：根据库存量自动分配批次号，避免超出库存限制
2. **实时日志**：详细的处理过程日志，便于跟踪和调试
3. **错误处理**：完善的错误检查和用户友好的错误提示
4. **多仓库支持**：支持多个仓库的数据同步处理
5. **进度显示**：实时显示处理进度和当前操作状态

## 故障排除

### 常见问题

1. **程序无法启动**：
   - 检查Python版本（需要3.8+）
   - 确保已安装所有依赖：`pip install -r requirements.txt`

2. **文件加载失败**：
   - 检查Excel文件是否损坏
   - 确认文件包含所有必要列
   - 检查文件是否被其他程序占用

3. **物料编码验证失败**：
   - 确认编码格式为 x.xx.x.xx.xx.xxx
   - 检查是否包含非数字字符
   - 确认有6段数字，用点分隔

4. **批次分配异常**：
   - 检查库存表中是否有对应的物料和仓库
   - 确认库存数量足够
   - 检查批次号和库存量数据格式

### 测试程序